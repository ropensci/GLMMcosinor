withr::local_seed(42)
simple_model <- cglmm(
  vit_d ~ amp_acro(time, group = "X", period = 12),
  data = vitamind
)
saveRDS(simple_model, test_path("fixtures", "simple_model.rds"))
multi_model <- cglmm(
  vit_d ~ amp_acro(time, group = "X", period = 12),
  dispformula = ~ amp_acro(time, group = "X", period = 12),
  ziformula = ~ amp_acro(time, group = "X", period = 12),
  data = vitamind
)
saveRDS(multi_model, test_path("fixtures", "multi_model.rds"))


d_multi_grp <- structure(
  list(
    id = c(
      12, 36, 21, 41, 22, 12, 41, 13, 5, 22,
      41, 30, 16, 26, 3, 6, 7, 7, 28, 3, 28, 28, 7, 9, 28, 23, 28,
      35, 19, 16, 24, 41, 34, 5, 2, 26, 24, 26, 32, 40, 23, 22, 1,
      25, 16, 18, 20, 32, 23, 12, 2, 40, 33, 32, 7, 24, 34, 41, 36,
      41, 2, 25, 3, 34, 22, 35, 7, 2, 13, 13, 2, 16, 31, 2, 26, 27,
      25, 24, 10, 12, 2, 4, 28, 30, 24, 25, 33, 2, 31, 34, 22, 33,
      16, 21, 2, 38, 36, 27, 32, 1
    ),
    g1 = c(
      1, 0, 1, 0, 0, 0, 1, 0,
      0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0,
      0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0,
      0, 1, 0, 0, 1, 1, 0, 0
    ),
    hour = c(
      9, 5, 4, 4, 22, 17, 1, 19,
      4, 20, 5, 15, 16, 16, 17, 18, 0, 10, 9, 4, 16, 6, 21, 3, 0, 14,
      14, 1, 10, 9, 2, 10, 6, 13, 10, 12, 15, 5, 17, 19, 21, 11, 20,
      23, 17, 22, 10, 19, 8, 23, 3, 11, 14, 1, 6, 17, 22, 23, 13, 16,
      21, 18, 11, 11, 19, 19, 5, 20, 13, 4, 23, 5, 11, 15, 22, 13,
      8, 11, 4, 14, 9, 16, 16, 20, 3, 9, 0, 8, 19, 23, 19, 23, 15,
      22, 2, 0, 17, 0, 13, 3
    ),
    g2 = c(
      0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
      0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1,
      1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1,
      1, 0, 0, 0, 0, 0
    ),
    response = c(
      94.1518963793373, 35.6926462694343,
      115.783336425586, 46.8232282179718, 89.9974884111715, 76.2385612128308,
      16.2619728164407, 49.0765353537745, 142.220163385935, 65.6881647648345,
      23.5336274795357, 44.4729364770444, 49.3203191675924, 65.5872345874686,
      58.2217678117373, 55.7763933082205, 117.438223545725, 160.824839298879,
      135.663836199941, 93.1979501563025, 109.864115011628, 88.873052796102,
      119.311906658108, 60.3697520284235, 145.794363145132, 126.714267597244,
      93.6564760062631, 120.550060477648, 66.1887428001, 75.9341437644408,
      29.3831291172717, 29.2502393189019, 208.657410025041, 170.826816384551,
      113.703159351824, 92.9643187122579, 67.8133477873174, 114.111834629376,
      145.062259549137, 44.5075967733435, 114.895958211305, 99.1947496722665,
      92.3706921624736, 47.1136274190307, 35.3739267034921, 143.348039057908,
      133.76675911593, 145.506741782833, 55.5870827007806, 58.9984467788661,
      141.080397592085, 95.1908701329185, 113.073972621526, 91.3814816813928,
      130.926691591526, 101.368868643671, 118.162847730366, 27.3823418737718,
      34.9981098914901, 32.5332527103048, 131.56504927669, 49.7614582834922,
      78.0590843829578, 117.70754931028, 125.900305246519, 74.4650849693249,
      114.749519415977, 143.866690219164, 84.2174692160787, 53.6140333277731,
      180.800321196118, 50.4001584326098, 97.5573645024332, 122.591695355017,
      99.03811625365, 85.0273513538854, 71.8911097955367, 53.8464214565556,
      35.5120322851206, 76.0447707352348, 163.355443538338, 58.2862851030596,
      139.938229568453, 41.1182852525775, 190.658920413312, 44.108471299706,
      58.9254953719591, 118.981295047712, 82.2123308816223, 291.63863365553,
      101.593694921824, 50.5353808177159, 92.5792700693684, 159.155228302244,
      87.5659678168308, 72.8065697432147, 42.8809581728313, 127.345157820769,
      185.857840649397, 71.3663378512698
    )
  ),
  row.names = c(NA, -100L),
  class = c("tbl_df", "tbl", "data.frame")
)

saveRDS(d_multi_grp, test_path("fixtures", "d_multi_grp.rds"))


d_multi_comp <- simulate_cosinor(
  n = 100, mesor = 0, amp = c(2, 4), acr = c(0, 1), period = c(12, 24),
  n_components = 2, beta.group = TRUE, beta.mesor = 1, beta.amp = c(0.5, 2),
  beta.acro = c(0.5, 2)
)

saveRDS(d_multi_comp, test_path("fixtures", "d_multi_comp.rds"))


# fixture to replicate the issue that @MilaSMayor was having on GitHub issue #29
# want to have two groups/factors which influence the amp/acro in a single
# component model

g1_amp <- 1
g2_amp <- 2
g1_acr <- 1
g2_acr <- 0.5

base_amp <- 1
base_acr <- 1

d_base <- simulate_cosinor(n = 100, mesor = 0, amp = base_amp, acr = base_acr, period = 24) |>
  mutate(g1 = 0, g2 = 0)
d_g1 <- simulate_cosinor(n = 100, mesor = 0, amp = base_amp + g1_amp, acr = base_acr + g1_acr, period = 24) |>
  mutate(g1 = 1, g2 = 0)
d_g2 <- simulate_cosinor(n = 100, mesor = 0, amp = base_amp + g2_amp, acr = base_acr + g2_acr, period = 24) |>
  mutate(g1 = 0, g2 = 1)
d_g1_g2 <- simulate_cosinor(n = 100, mesor = 0, amp = base_amp + g1_amp + g2_amp, acr = base_acr + g1_acr + g2_acr, period = 24) |>
  mutate(g1 = 1, g2 = 1)

d_multi_grp_same_period <- bind_rows(d_base, d_g1, d_g2, d_g1_g2) |> select(-group)


saveRDS(d_multi_grp_same_period, test_path("fixtures", "d_multi_grp_same_period.rds"))
