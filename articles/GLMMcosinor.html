<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="GLMMcosinor">
<title>GLMMcosinor • GLMMcosinor</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="GLMMcosinor">
<meta property="og:description" content="GLMMcosinor">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">GLMMcosinor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/GLMMcosinor.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data-simulations.html">data-simulations</a>
    <a class="dropdown-item" href="../articles/mixed-models.html">mixed-models</a>
    <a class="dropdown-item" href="../articles/model-specification.html">model-specification</a>
    <a class="dropdown-item" href="../articles/model-visualisations.html">model-visualisations</a>
    <a class="dropdown-item" href="../articles/multiple-components.html">multiple-components</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/RWParsons/GLMMcosinor/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<link href="GLMMcosinor_files/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="GLMMcosinor_files/tabwid-1.1.3/tabwid.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>GLMMcosinor</h1>
                        <h4 data-toc-skip class="author">Oliver
Jayasinghe and Rex Parsons</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RWParsons/GLMMcosinor/blob/HEAD/vignettes/GLMMcosinor.Rmd" class="external-link"><code>vignettes/GLMMcosinor.Rmd</code></a></small>
      <div class="d-none name"><code>GLMMcosinor.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RWParsons/GLMMcosinor" class="external-link">GLMMcosinor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="va">testdata_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_cosinor.html">simulate_cosinor</a></span><span class="op">(</span><span class="fl">1000</span>,</span>
<span>  n_period <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  mesor <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  amp <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  acro <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta.mesor <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  beta.amp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta.acro <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta.group <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">testdata_two_components</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_cosinor.html">simulate_cosinor</a></span><span class="op">(</span><span class="fl">1000</span>,</span>
<span>  n_period <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  mesor <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>  acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  beta.mesor <span class="op">=</span> <span class="fl">4.4</span>,</span>
<span>  beta.amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  beta.acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  beta.group <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">testdata_multicomponent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_cosinor.html">simulate_cosinor</a></span><span class="op">(</span><span class="fl">1000</span>,</span>
<span>  n_period <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  mesor <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  beta.mesor <span class="op">=</span> <span class="fl">4.4</span>,</span>
<span>  beta.amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>  beta.acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  beta.group <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">1</span>, period <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"X"</span></span>
<span><span class="op">)</span>, data <span class="op">=</span> <span class="va">vitamind</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">object</span>, superimpose.data <span class="op">=</span> <span class="cn">TRUE</span>, x_str <span class="op">=</span> <span class="st">"X"</span>, predict.ribbon <span class="op">=</span> <span class="cn">FALSE</span>, data_opacity <span class="op">=</span> <span class="fl">0.08</span><span class="op">)</span></span></code></pre></div>
<p><img src="GLMMcosinor_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <a href="https://github.com/RWParsons/GLMMcosinor" class="external-link">GLMMcosinor</a> package allows the user to fit
generalised linear models based on circadian data, and allows users to
summarise, predict, and plot based on this modelling. Existing packages
have focused primarily on Gaussian data. Some circadian regression
modelling packages have allowed users to specify generalised linear
models, but with limited flexibility. GLMMcosinor takes a comprehensive
approach to modelling by utilising the glmmTMB package, which allows
users to model circadian data from a wide range of distributions (for
full list - see <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">?family</a></code> and
<code><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html" class="external-link">?glmmTMB::family_glmmTMB</a></code>) including:</p>
<ul>
<li>Binomial</li>
<li>Guassian</li>
<li>Inverse Gaussian</li>
<li>Gamma</li>
<li>Poisson</li>
<li>Negative Binomial</li>
</ul>
<p>The table below shows what features are available within GLMMcosinor
and other methods.</p>
<div class="tabwid">
<style>.cl-0326d7f4{}.cl-031b7616{font-family:'DejaVu Sans';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-031b762a{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-031b7634{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 255, 0, 1.00);background-color:transparent;}.cl-031b7635{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(255, 0, 0, 1.00);background-color:transparent;}.cl-032067a2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-032087dc{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-032087e6{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-032087f0{width:0.75in;background-color:rgba(255, 255, 255, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="table cl-0326d7f4">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-032087dc"><p class="cl-032067a2"><span class="cl-031b7616">Software</span></p></th>
<th class="cl-032087dc"><p class="cl-032067a2"><span class="cl-031b7616">Language</span></p></th>
<th class="cl-032087dc"><p class="cl-032067a2"><span class="cl-031b7616">Multicomponent</span></p></th>
<th class="cl-032087dc"><p class="cl-032067a2"><span class="cl-031b7616">Dispersion model</span></p></th>
<th class="cl-032087dc"><p class="cl-032067a2"><span class="cl-031b7616">Zero-inflated model</span></p></th>
<th class="cl-032087dc"><p class="cl-032067a2"><span class="cl-031b7616">Differential rhythmicity</span></p></th>
<th class="cl-032087dc"><p class="cl-032067a2"><span class="cl-031b7616">Parameter estimates for differences</span></p></th>
<th class="cl-032087dc"><p class="cl-032067a2"><span class="cl-031b7616">Family (available link functions)</span></p></th>
<th class="cl-032087dc"><p class="cl-032067a2"><span class="cl-031b7616">Estimated parameters</span></p></th>
<th class="cl-032087dc"><p class="cl-032067a2"><span class="cl-031b7616">Reference</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">GLMMcosinor</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">R</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">n</span><span class="cl-031b762a"> </span><span class="cl-031b762a">&gt;</span><span class="cl-031b762a"> </span><span class="cl-031b762a">15</span><span class="cl-031b762a"> </span><span class="cl-031b762a">Any</span><span class="cl-031b762a"> </span><span class="cl-031b762a">family</span><span class="cl-031b762a"> </span><span class="cl-031b762a">avilable</span><span class="cl-031b762a"> </span><span class="cl-031b762a">in</span><span class="cl-031b762a"> </span><span class="cl-031b762a">{glmmTMB}:</span><span class="cl-031b762a"> </span><span class="cl-031b762a">Gaussian,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">gamma,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">binomial,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">Poisson,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">…</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">Amplitude,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">acrophase,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">MESOR</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">Parsons,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">2023</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">CircaCompare</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">R</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">n</span><span class="cl-031b762a"> </span><span class="cl-031b762a">=</span><span class="cl-031b762a"> </span><span class="cl-031b762a">1</span><span class="cl-031b762a"> </span><span class="cl-031b762a">Gaussian</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">Amplitude,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">acrophase,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">MESOR,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">and</span><span class="cl-031b762a"> </span><span class="cl-031b762a">exponential</span><span class="cl-031b762a"> </span><span class="cl-031b762a">decay</span><span class="cl-031b762a"> </span><span class="cl-031b762a">of</span><span class="cl-031b762a"> </span><span class="cl-031b762a">any</span><span class="cl-031b762a"> </span><span class="cl-031b762a">of</span><span class="cl-031b762a"> </span><span class="cl-031b762a">these</span><span class="cl-031b762a"> </span><span class="cl-031b762a">characteristics</span><span class="cl-031b762a"> </span><span class="cl-031b762a">or</span><span class="cl-031b762a"> </span><span class="cl-031b762a">the</span><span class="cl-031b762a"> </span><span class="cl-031b762a">differences</span><span class="cl-031b762a"> </span><span class="cl-031b762a">in</span><span class="cl-031b762a"> </span><span class="cl-031b762a">them</span><span class="cl-031b762a"> </span><span class="cl-031b762a">between</span><span class="cl-031b762a"> </span><span class="cl-031b762a">groups</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">Parsons,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">2020</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">Cosinor</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">R</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">n</span><span class="cl-031b762a"> </span><span class="cl-031b762a">=</span><span class="cl-031b762a"> </span><span class="cl-031b762a">1</span><span class="cl-031b762a"> </span><span class="cl-031b762a">Gaussian</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">Amplitude,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">acrophase,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">MESOR</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">Sachs,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">2014</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">Cosinor2</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">R</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">n</span><span class="cl-031b762a"> </span><span class="cl-031b762a">=</span><span class="cl-031b762a"> </span><span class="cl-031b762a">1</span><span class="cl-031b762a"> </span><span class="cl-031b762a">Gaussian</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">Amplitude,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">acrophase,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">MESOR</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">Mutak,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">2018</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">CosinorPy</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">Python</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">n</span><span class="cl-031b762a"> </span><span class="cl-031b762a">=</span><span class="cl-031b762a"> </span><span class="cl-031b762a">3</span><span class="cl-031b762a"> </span><span class="cl-031b762a">Gaussian,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">Poisson,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">negative-binomial</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">Amplitude,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">acrophase,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">MESOR</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">Moskon,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">2020</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">DiscoRhythm</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">R</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">n</span><span class="cl-031b762a"> </span><span class="cl-031b762a">=</span><span class="cl-031b762a"> </span><span class="cl-031b762a">1</span><span class="cl-031b762a"> </span><span class="cl-031b762a">Gaussian</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">Amplitude,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">acrophase</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">Carlucci,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">2019</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">FMM</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">R</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">n</span><span class="cl-031b762a"> </span><span class="cl-031b762a">=</span><span class="cl-031b762a"> </span><span class="cl-031b762a">1</span><span class="cl-031b762a"> </span><span class="cl-031b762a">Gaussian</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">Amplitude,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">FMM</span><span class="cl-031b762a"> </span><span class="cl-031b762a">phase</span><span class="cl-031b762a"> </span><span class="cl-031b762a">angle</span><span class="cl-031b762a"> </span><span class="cl-031b762a">parameters:</span><span class="cl-031b762a"> </span><span class="cl-031b762a">alpha,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">beta,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">gamma</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">Fernández,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">2022</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">Kronos</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">R</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">n</span><span class="cl-031b762a"> </span><span class="cl-031b762a">=</span><span class="cl-031b762a"> </span><span class="cl-031b762a">1</span><span class="cl-031b762a"> </span><span class="cl-031b762a">Gaussian</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">Amplitude,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">acrophase,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">MESOR</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">Singer,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">2019</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">LimoRhyde</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">R</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">n</span><span class="cl-031b762a"> </span><span class="cl-031b762a">=</span><span class="cl-031b762a"> </span><span class="cl-031b762a">1</span><span class="cl-031b762a"> </span><span class="cl-031b762a">Gaussian</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">Amplitude,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">acrophase,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">MESOR,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">period</span></p></td>
<td class="cl-032087e6"><p class="cl-032067a2"><span class="cl-031b762a">Singer,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">2019</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">RhythmCount</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">Python</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7635">✗</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b7634">✓</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">n</span><span class="cl-031b762a"> </span><span class="cl-031b762a">=</span><span class="cl-031b762a"> </span><span class="cl-031b762a">6</span><span class="cl-031b762a"> </span><span class="cl-031b762a">Poisson,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">generalised-Poisson,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">zero-inflated</span><span class="cl-031b762a"> </span><span class="cl-031b762a">Poisson,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">negative</span><span class="cl-031b762a"> </span><span class="cl-031b762a">binomial,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">zero-inflated</span><span class="cl-031b762a"> </span><span class="cl-031b762a">negative-binomial</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">Amplitude,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">acrophase,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">MESOR,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">Zenith</span></p></td>
<td class="cl-032087f0"><p class="cl-032067a2"><span class="cl-031b762a">Velikajne,</span><span class="cl-031b762a"> </span><span class="cl-031b762a">2022</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="cosinor-glmm">
<code>cosinor.glmm()</code><a class="anchor" aria-label="anchor" href="#cosinor-glmm"></a>
</h2>
<p><code><a href="../reference/cosinor.glmm.html">cosinor.glmm()</a></code> wrangles the data appropriately to fit
the cosinor model given the formula specified by the user. It provides
estimates of amplitude, acrophase, and MESOR (Midline Statistic Of
Rhythm).</p>
<p>The formula argument for <code><a href="../reference/cosinor.glmm.html">cosinor.glmm()</a></code> is specified
using the <a href="https://github.com/lme4/lme4/" class="external-link">lme4</a> style (for details see
<code><a href="https://cran.rstudio.com/web/packages/lme4/vignettes/lmer.pdf" class="external-link">vignette("lmer", package = "lme4")</a></code>). The only difference is
that it allows for use of an <code><a href="../reference/amp_acro.html">amp_acro()</a></code> call within the
formula that is used to identify the circadian components and relevant
variables in the <code>data.frame</code>. Any other combination of
covariates can also be included in the formula as well as random effects
and zero-inflation (<code>ziformula</code>) and dispersion
(<code>dispformula</code>) formulae. For detailed examples of how to
specify models, see the <a href="https://rwparsons.github.io/GLMMcosinor/articles/mixed-models.html">mixed-models</a>,
<a href="https://rwparsons.github.io/GLMMcosinor/articles/model-specification.html">model-specification</a>
and <a href="https://rwparsons.github.io/GLMMcosinor/articles/multiple-components.html">multiple-components</a>
vignettes.</p>
</div>
<div class="section level2">
<h2 id="an-overview-of-the-statistical-methods-used-for-parameter-estimation">An overview of the statistical methods used for parameter
estimation<a class="anchor" aria-label="anchor" href="#an-overview-of-the-statistical-methods-used-for-parameter-estimation"></a>
</h2>
<p>The <a href="https://github.com/RWParsons/GLMMcosinor" class="external-link">GLMMcosinor</a> package provides estimates of
amplitude (<span class="math inline">\(A\)</span>), acrophase (<span class="math inline">\(\phi\)</span>), and MESOR (<span class="math inline">\(M\)</span>). In the single-component case, these
parameters correspond to the following regression model:</p>
<p><span class="math display">\[Y(t) = M + Acos(\frac{2\pi t}{\tau} +
\phi) + e(t)\]</span> where <span class="math inline">\(e(t)\)</span> is
the error term.</p>
<p>This model can be equivalently expressed as a generalised linear
model:</p>
<p><span class="math display">\[Y(t) = M + \beta x + \gamma z +
e(t)\]</span></p>
<p>Where <span class="math inline">\(x =cos(\frac{2\pi t}{τ}\times
\pi)\)</span>, <span class="math inline">\(z =sin(\frac{2\pi t}{τ}\times
\pi)\)</span>, <span class="math inline">\(\beta = A cos(\phi)\)</span>,
<span class="math inline">\(\gamma = -A sin(\phi)\)</span></p>
<p>In our code, the <code><a href="../reference/amp_acro.html">amp_acro()</a></code> function will modify the
dataset supplied in the <code><a href="../reference/cosinor.glmm.html">cosinor.glmm()</a></code> call by creating two
transformed columns of data: <code>rrr</code> and <code>sss</code> which
take the role of <span class="math inline">\(x\)</span> and <span class="math inline">\(z\)</span> respectively from the equation above.
‘rrr’ and ‘sss’ are treated as variables, and the estimates of their
coefficients are therefore <span class="math inline">\(\hat\beta\)</span> and <span class="math inline">\(\hat\gamma\)</span>. These estimates are what is
presented in as ‘Raw Coefficients’ in the output of the
<code><a href="../reference/cosinor.glmm.html">cosinor.glmm()</a></code> function. Depending on the model
specification, an estimate for MESOR (‘(Intercept)’) may be present and
this does not need to be transformed. For this reason, the MESOR terms
will be the same in both the raw and transformed coefficient tables in
the output. But, to get the estimates for amplitude (<span class="math inline">\(A\)</span>) and acrophase (<span class="math inline">\(\phi\)</span>), the estimates for <span class="math inline">\(\hat\beta\)</span> and <span class="math inline">\(\hat\gamma\)</span> must be transformed as per the
following equations:</p>
<p><span class="math display">\[\hat\phi =
\arctan(\frac{-\hat\gamma}{\hat\beta}) \]</span></p>
<p><span class="math display">\[\hat A = (\hat\beta ^2 + \hat\gamma ^ 2)
^ \frac{1}{2} \]</span></p>
<p>These transformations are handled by the internal function
<code>get_new_coefs()</code> inside the <code>data_utils.R</code>
script. The result of these transformations is what is presented in the
‘Transformed Coefficients’ table as part of the
<code><a href="../reference/cosinor.glmm.html">cosinor.glmm()</a></code> output.</p>
<p>For example, consider the following model and its output:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, period <span class="op">=</span> <span class="fl">12</span>, group <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ X + X:main_rrr1 + X:main_sss1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;              Estimate</span></span>
<span><span class="co">#&gt; (Intercept)  29.68980</span></span>
<span><span class="co">#&gt; X1            1.90186</span></span>
<span><span class="co">#&gt; X0:main_rrr1  0.93079</span></span>
<span><span class="co">#&gt; X1:main_rrr1  6.51029</span></span>
<span><span class="co">#&gt; X0:main_sss1  6.20099</span></span>
<span><span class="co">#&gt; X1:main_sss1  4.81846</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;             Estimate</span></span>
<span><span class="co">#&gt; (Intercept) 29.68980</span></span>
<span><span class="co">#&gt; [X=1]        1.90186</span></span>
<span><span class="co">#&gt; [X=0]:amp    6.27046</span></span>
<span><span class="co">#&gt; [X=1]:amp    8.09947</span></span>
<span><span class="co">#&gt; [X=0]:acr   -1.42181</span></span>
<span><span class="co">#&gt; [X=1]:acr   -0.63715</span></span></code></pre></div>
<p>Notice how both the raw and transformed coefficients are provided as
output. Also, notice how the dataframe is modified to include
<code>main_rrr1</code> and <code>main_sss1</code> columns of data. This
is the data that the <code>glmmTMB()</code> function fits a regression
model to:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">object</span><span class="op">$</span><span class="va">newdata</span><span class="op">)</span></span>
<span><span class="co">#&gt;   X        Y      time  main_rrr1  main_sss1</span></span>
<span><span class="co">#&gt; 1 0 16.12091 11.439525  0.9572476 -0.2892699</span></span>
<span><span class="co">#&gt; 2 0 29.90624  5.807104 -0.9949038  0.1008285</span></span>
<span><span class="co">#&gt; 3 1 39.17572  1.045492  0.8538711  0.5204846</span></span>
<span><span class="co">#&gt; 4 1 35.15403  4.082983 -0.5371451  0.8434899</span></span>
<span><span class="co">#&gt; 5 1 43.67065 10.606247  0.7453295 -0.6666963</span></span>
<span><span class="co">#&gt; 6 0 31.20360  5.126054 -0.8971168  0.4417935</span></span></code></pre></div>
<p>In this example, the <code>main</code> prefix indicates that this is
the data for the conditional model, as opposed to potential dispersion
or zero-inflation models which have the prefixes <code>disp</code> and
<code>zi</code> respectively. The numeric suffix 1 indicates that this
is the data for component 1. If there are multiple components, the
columns of data will be named accordingly. These naming conventions are
consistent throughout the <a href="https://github.com/RWParsons/GLMMcosinor" class="external-link">GLMMcosinor</a> package.</p>
<p>The transformations behind multi-component models follow the same
principles, and a more detailed discussion of this process in addition
to the other statistics used in this package can be found in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3991883" class="external-link">‘Cosinor-based
rhythmometry’</a> (Cornelissen, 2014).</p>
</div>
<div class="section level2">
<h2 id="a-basic-overview-of-cosinor-glmm">A basic overview of <code>cosinor.glmm()</code><a class="anchor" aria-label="anchor" href="#a-basic-overview-of-cosinor-glmm"></a>
</h2>
<p>The <code><a href="../reference/cosinor.glmm.html">cosinor.glmm()</a></code> function is used to fit cosinor
models to a variety of distributions using the <code>glmmTMB()</code>
function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">Y</span> <span class="op">~</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, period <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">vitamind</span></span>
<span><span class="va">family</span> <span class="op">&lt;-</span> <span class="va">gaussian</span></span>
<span></span>
<span><span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">family</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ main_rrr1 + main_sss1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;             Estimate</span></span>
<span><span class="co">#&gt; (Intercept) 30.25467</span></span>
<span><span class="co">#&gt; main_rrr1    2.59418</span></span>
<span><span class="co">#&gt; main_sss1    5.75079</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;             Estimate</span></span>
<span><span class="co">#&gt; (Intercept) 30.25467</span></span>
<span><span class="co">#&gt; amp          6.30883</span></span>
<span><span class="co">#&gt; acr         -1.14703</span></span></code></pre></div>
<ul>
<li>
<code>formula</code>: A formula specifying the model structure,
including the response variable and the cosinor components. The formula
specification relies on the <code>amp_acro</code> function to handle the
transformations. This formula is outlined below.</li>
<li>
<code>data</code>: The dataset containing the variables used in the
formula.</li>
<li>
<code>family</code>: The family of the distribution for the response
variable (e.g., poisson, gaussian, or any family found
in<code><a href="https://rdrr.io/r/stats/family.html" class="external-link">?family</a></code> and <code><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html" class="external-link">?glmmTMB::family_glmmTMB</a></code>)</li>
</ul>
<p>The <code><a href="../reference/amp_acro.html">amp_acro()</a></code> function is used within the formula to
specify the cosinor components. It allows you to control the grouping
structure, rhythm period, and the number of components. The arguments of
<code><a href="../reference/amp_acro.html">amp_acro()</a></code> include:</p>
<ul>
<li>
<code>group</code>: The name of the grouping variable in the
dataset.</li>
<li>
<code>time_col</code>: The name of the time column.</li>
<li>
<code>n_components</code>: The number of components in the cosinor
model.</li>
<li>
<code>period</code>: The period(s) of the rhythm.</li>
</ul>
<div class="section level3">
<h3 id="understanding-the-output">Understanding the output<a class="anchor" aria-label="anchor" href="#understanding-the-output"></a>
</h3>
<p>The most important output from the <code><a href="../reference/cosinor.glmm.html">cosinor.glmm()</a></code>
function is likely to be the parameter estimates for MESOR, amplitude,
and acrophase under the ‘Transformed Coefficients’ heading. A detailed
explanation of the difference between the raw coefficients and the
transformed coefficients is found in this vignette, in the <strong>‘An
overview of the statistical methods used for parameter
estimation’</strong> section.</p>
<p>The following example looks at a grouped single-component model based
on a Gaussian distribution from the <code>vitamind</code> dataset.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, period <span class="op">=</span> <span class="fl">12</span>, group <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ X + X:main_rrr1 + X:main_sss1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;              Estimate</span></span>
<span><span class="co">#&gt; (Intercept)  29.68980</span></span>
<span><span class="co">#&gt; X1            1.90186</span></span>
<span><span class="co">#&gt; X0:main_rrr1  0.93079</span></span>
<span><span class="co">#&gt; X1:main_rrr1  6.51029</span></span>
<span><span class="co">#&gt; X0:main_sss1  6.20099</span></span>
<span><span class="co">#&gt; X1:main_sss1  4.81846</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;             Estimate</span></span>
<span><span class="co">#&gt; (Intercept) 29.68980</span></span>
<span><span class="co">#&gt; [X=1]        1.90186</span></span>
<span><span class="co">#&gt; [X=0]:amp    6.27046</span></span>
<span><span class="co">#&gt; [X=1]:amp    8.09947</span></span>
<span><span class="co">#&gt; [X=0]:acr   -1.42181</span></span>
<span><span class="co">#&gt; [X=1]:acr   -0.63715</span></span></code></pre></div>
<p>Under the ‘Transformed Coefficients’ heading:</p>
<ul>
<li><p><code>(Intercept) = 29.6898</code>is the MESOR estimate of group
0</p></li>
<li><p><code>[X=1] = 1.90186</code> is the difference between the MESOR
estimates of group 1 and 2 *</p></li>
<li><p><code>[X=0]:amp = 6.27046</code> is the amplitude estimate for
group 0</p></li>
<li><p><code>[X=1]:amp = 8.09947</code> is the amplitude estimate for
group 1</p></li>
<li><p><code>[X=0]:acr = -1.42181</code> is the acrophase estimate for
group 0</p></li>
<li><p><code>[X=1]:acr = -0.63715</code> is the acrophase estimate for
group 1</p></li>
</ul>
<p>* Hence, the MESOR estimate for group 1 would be
<code>29.6898 + 1.90186 = 31.59166</code>. This is due to the behaviour
of the <code>glmmTMB()</code> function. This can be adjusted by adding a
<code>0 +</code> to the beginning of the formula:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, period <span class="op">=</span> <span class="fl">12</span>, group <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ X + X:main_rrr1 + X:main_sss1 - 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;              Estimate</span></span>
<span><span class="co">#&gt; X0           29.68980</span></span>
<span><span class="co">#&gt; X1           31.59165</span></span>
<span><span class="co">#&gt; X0:main_rrr1  0.93079</span></span>
<span><span class="co">#&gt; X1:main_rrr1  6.51029</span></span>
<span><span class="co">#&gt; X0:main_sss1  6.20101</span></span>
<span><span class="co">#&gt; X1:main_sss1  4.81847</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;           Estimate</span></span>
<span><span class="co">#&gt; [X=0]     29.68980</span></span>
<span><span class="co">#&gt; [X=1]     31.59165</span></span>
<span><span class="co">#&gt; [X=0]:amp  6.27048</span></span>
<span><span class="co">#&gt; [X=1]:amp  8.09948</span></span>
<span><span class="co">#&gt; [X=0]:acr -1.42181</span></span>
<span><span class="co">#&gt; [X=1]:acr -0.63716</span></span></code></pre></div>
<p>Note how now, <code>[X=1] = 31.59165</code> and this represents the
estimate for the MESOR for group 1, rather than the difference.</p>
</div>
</div>
<div class="section level2">
<h2 id="more-advanced-cosinor-glmm-model-specification">More advanced <code>cosinor.glmm()</code> model specification<a class="anchor" aria-label="anchor" href="#more-advanced-cosinor-glmm-model-specification"></a>
</h2>
<p>The <code><a href="../reference/cosinor.glmm.html">cosinor.glmm()</a></code> function allows you to specify
different types of cosinor models with or without grouping variables.
The function can also generate dispersion models and zero-inflation
models in addition to the conditional model that is generated by
default. For more detailed explanations and examples, see the <a href="https://rwparsons.github.io/GLMMcosinor/articles/model-specification.html">model-specification</a>
article.</p>
<p>Additionally, the <code><a href="../reference/cosinor.glmm.html">cosinor.glmm()</a></code> function provides more
advanced functionalities for multi-component models, and detailed
explanations can be found in the <a href="https://rwparsons.github.io/GLMMcosinor/articles/multiple-components.html">multiple-components</a>
article.</p>
<p>The cosinor.glmm() function also allows mixed model specification.
See the <a href="https://rwparsons.github.io/GLMMcosinor/articles/mixed-models.html">mixed-models</a>
article for more details.</p>
</div>
<div class="section level2">
<h2 id="using-summary">Using <code>summary()</code><a class="anchor" aria-label="anchor" href="#using-summary"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method for <code>cosinor.glmm</code>
objects provides a more detailed summary of the model and its parameter
estimates and uncertainty. It outputs the estimates, standard errors,
confidence intervals, and p-values for both the raw model parameters and
the transformed parameters. The summary statistics do not represent a
comparison between any groups for the cosinor components - that is the
role of the <code><a href="../reference/test_cosinor_components.html">test_cosinor_components()</a></code> and
<code><a href="../reference/test_cosinor_levels.html">test_cosinor_levels()</a></code> functions.</p>
<p>Here is an example of how to use <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>, period <span class="op">=</span> <span class="fl">12</span>, group <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">testdata_simple</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; Raw model coefficients:</span></span>
<span><span class="co">#&gt;                      estimate standard.error     lower.CI upper.CI    p.value</span></span>
<span><span class="co">#&gt; (Intercept)       4.996897043    0.003507336  4.990022790  5.00377 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1           -0.992254309    0.005929334 -1.003875590 -0.98063 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group0:main_rrr1  1.080439664    0.003352984  1.073867937  1.08701 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_rrr1  0.872496192    0.006325846  0.860097762  0.88489 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group0:main_sss1 -1.688861736    0.003940962 -1.696585881 -1.68114 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_sss1 -0.476000935    0.005748628 -0.487268039 -0.46473 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt;                     </span></span>
<span><span class="co">#&gt; (Intercept)      ***</span></span>
<span><span class="co">#&gt; group1           ***</span></span>
<span><span class="co">#&gt; group0:main_rrr1 ***</span></span>
<span><span class="co">#&gt; group1:main_rrr1 ***</span></span>
<span><span class="co">#&gt; group0:main_sss1 ***</span></span>
<span><span class="co">#&gt; group1:main_sss1 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Transformed coefficients:</span></span>
<span><span class="co">#&gt;                    estimate standard.error     lower.CI upper.CI    p.value    </span></span>
<span><span class="co">#&gt; (Intercept)     4.996897043    0.003507336  4.990022790  5.00377 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]      -0.992254309    0.005929334 -1.003875590 -0.98063 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:amp1  2.004894968    0.004294992  1.996476939  2.01331 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:amp1  0.993894609    0.007587174  0.979024021  1.00877 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:acr1  1.001664558    0.001439281  0.998843619  1.00449 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:acr1  0.499429681    0.006541594  0.486608392  0.51225 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-predict">Using <code>predict()</code><a class="anchor" aria-label="anchor" href="#using-predict"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method for <code>cosinor.glmm</code>
objects allows users to get predicted values from the model on either
the existing or new data. (These predicted values are used when
generating the plots using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.)</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>, period <span class="op">=</span> <span class="fl">12</span>, group <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">testdata_simple</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.698703 3.735857 5.024884 5.295314 5.591113 5.081111</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plotting-cosinor-glmm-objects">Plotting <code>cosinor.glmm</code> objects<a class="anchor" aria-label="anchor" href="#plotting-cosinor-glmm-objects"></a>
</h2>
<p>The <a href="https://github.com/RWParsons/GLMMcosinor" class="external-link">GLMMcosinor</a> package includes two ways to visualise
<code><a href="../reference/cosinor.glmm.html">cosinor.glmm()</a></code> objects. Firstly, the
<code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code> method creates a time-response plot of the
fitted model for all groups:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>, period <span class="op">=</span> <span class="fl">12</span>, group <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">testdata_simple</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">object</span>, superimpose.data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="GLMMcosinor_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>This function also allows users to superimpose the data (that was
used to fit the model) over the fitted model, using the
<code>superimpose.data = TRUE</code>, as demonstrated above. By default,
the generated plot will have x-limits corresponding to the minimum and
maximum values of the time-vector in the original dataframe, although
the x-limits can be manually defined by the user using the
<code>xlims</code> argument. The details of using the
<code>autoplot</code> function are found in the <a href="https://rwparsons.github.io/GLMMcosinor/articles/model-visualisations.html">model-visualisations</a>
vignette.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Rex Parsons, Oliver Jayasinghe.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
